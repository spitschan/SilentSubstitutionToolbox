function [S, wls, T_oxy, T_deoxy, units] = GetHemoglobin(source)
% [S, wls, T_oxy, T_deoxy, units] = GetHemoglobin(source)
%
% Wrapper function to get hemoglobin extinction/absorptivity/absorption
% functions. Currently, the estimates by van Kampen & Ziljstra (1983) and
% Prahl (2014) are returned. 
%
% NOTE: They come in different units, which is why we also return the
% 'units' string.
%
% Input:
%           source (str)    - Source. Either 'vanKampen' or 'Prahl'
%
% Output:
%           S (1x3)         - Wavelength spacing in typical 'S' (if
%                             available).
%           wls (1xN)       - Wavelengths in 'wls' format.
%           T_oxy (1xN)     - Oxyhemoglobin estimate (if available).
%           T_deoxy (1xN)   - Deoxyhemoglobin estimate (if available);
%           units (str)     - Units of the estimate.
%
% If any of these are unassigned, the empty matrix is returned.
%
% 6/2/2014  ms      Wrote it.

switch source
    case 'vanKampen'
        % Packer & Williams in Shevell (2003) plot out the absorptivity of
        % oxyhemoglobin. The reference is to Van Kampen & Ziljstra (1983)
        % who list the millimolar absorptivity of HbO2 in Table 5 (p. 226) as follows.
        
        % Report units.
        units = 'liters mmol^-1 cm^-1';
        
        % Report wavelength spacing.
        S = [];
        wls = [415
            497
            506.5
            510
            522
            525.5
            540
            542
            548.5
            549.5
            560
            569
            572.5
            577
            586
            590.5
            592
            690
            815
            930]; % nm
        
        % Return estimate.
        T_oxy = [131
            5.16
            4.81
            4.76
            6.42
            7.72
            14.27
            14.37
            12.46
            12.06
            8.47
            11.27
            13.50
            15.37
            7.23
            3.62
            2.13
            0.07
            0.22
            0.31]; % liters mmol^-1 cm^-1
        T_deoxy = [];
        
    case 'Prahl'
        % Return wavelengths as well as oxyhemoglobin and deoxyhemoglobin
        % molar extinction coefficients. This is from
        % http://omlc.ogi.edu/spectra/hemoglobin/summary.html, based on a
        % data set compiled by Scott Prahl (Oregon Medical Laser Center).
        % Original data are reported to be from:
        % 
        % W. B. Gratzer, Med. Res. Council Labs, Holly Hill, London N. Kollias,
        % Wellman Laboratories, Harvard Medical School, Boston
        %
        % Data obtained 6/2/2014.

        % Report units.
        units = 'cm-1/M';
        
        % Report wavelength spacing.
        S = [250 2 376];
        wls = SToWls(S);
        
        % Return estimate.
        T_oxy = [106112
            105552
            107660
            109788
            112944
            116376
            120188
            124412
            128696
            133064
            136068
            137232
            138408
            137424
            135820
            131936
            127720
            122280
            116508
            108484
            104752
            98936
            88136
            79316
            70884
            65972
            63208
            61952
            62352
            62856
            63352
            65972
            69016
            72404
            75536
            78752
            82256
            85972
            89796
            93768
            97512
            100964
            103504
            104968
            106452
            107884
            109060
            110092
            109032
            107984
            106576
            105040
            103696
            101568
            97828
            94744
            92248
            89836
            88484
            87512
            88176
            91592
            95140
            98936
            103432
            109564
            116968
            125420
            135132
            148100
            167748
            189740
            212060
            231612
            248404
            266232
            284224
            308716
            354208
            422320
            466840
            500200
            524280
            521880
            515520
            480360
            431880
            376236
            326032
            283112
            246072
            214120
            165332
            132820
            119140
            102580
            92780
            81444
            76324
            67044
            62816
            58864
            53552
            49496
            47496
            44480
            41320
            39807.2
            37073.2
            34870.8
            33209.2
            31620
            30113.6
            28850.8
            27718
            26629.2
            25701.6
            25180.4
            24669.6
            24174.8
            23684.4
            23086.8
            22457.6
            21850.4
            21260
            20932.8
            20596.4
            20418
            19946
            19996
            20035.2
            20150.4
            20429.2
            21001.6
            22509.6
            24202.4
            26450.4
            29269.2
            32496.4
            35990
            39956.8
            43876
            46924
            49752
            51712
            53236
            53292
            52096
            49868
            46660
            43016
            39675.2
            36815.2
            34476.8
            33456
            32613.2
            32620
            33915.6
            36495.2
            40172
            44496
            49172
            53308
            55540
            54728
            50104
            43304
            34639.6
            26600.4
            19763.2
            14400.8
            10468.4
            7678.8
            5683.6
            4504.4
            3200
            2664
            2128
            1789.2
            1647.6
            1506
            1364.4
            1222.8
            1110
            1026
            942
            858
            774
            707.6
            658.8
            610
            561.2
            512.4
            478.8
            460.4
            442
            423.6
            405.2
            390.4
            379.2
            368
            356.8
            345.6
            335.2
            325.6
            319.6
            314
            308.4
            302.8
            298
            294
            290
            285.6
            282
            279.2
            277.6
            276
            274.4
            272.8
            274.4
            276
            277.6
            279.2
            282
            286
            290
            294
            298
            302.8
            308.4
            314
            319.6
            325.2
            332
            340
            348
            356
            364
            372.4
            381.2
            390
            398.8
            407.6
            418.8
            432.4
            446
            459.6
            473.2
            487.6
            502.8
            518
            533.2
            548.4
            562
            574
            586
            598
            610
            622.8
            636.4
            650
            663.6
            677.2
            689.2
            699.6
            710
            720.4
            730.8
            740
            748
            756
            764
            772
            786.4
            807.2
            816
            828
            836
            844
            856
            864
            872
            880
            887.2
            901.6
            916
            930.4
            944.8
            956.4
            965.2
            974
            982.8
            991.6
            1001.2
            1011.6
            1022
            1032.4
            1042.8
            1050
            1054
            1058
            1062
            1066
            1072.8
            1082.4
            1092
            1101.6
            1111.2
            1118.4
            1123.2
            1128
            1132.8
            1137.6
            1142.8
            1148.4
            1154
            1159.6
            1165.2
            1170
            1174
            1178
            1182
            1186
            1190
            1194
            1198
            1202
            1206
            1209.2
            1211.6
            1214
            1216.4
            1218.8
            1220.8
            1222.4
            1224
            1225.6
            1227.2
            1226.8
            1224.4
            1222
            1219.6
            1217.2
            1215.6
            1214.8
            1214
            1213.2
            1212.4
            1210.4
            1207.2
            1204
            1200.8
            1197.6
            1194
            1190
            1186
            1182
            1178
            1173.2
            1167.6
            1162
            1156.4
            1150.8
            1144
            1136
            1128
            1120
            1112
            1102.4
            1091.2
            1080
            1068.8
            1057.6
            1046.4
            1035.2
            1024]; % cm-1/M
        
        T_deoxy = [112736
            112736
            112736
            113824
            115040
            116296
            117564
            118876
            120208
            121544
            122880
            123096
            121952
            120808
            119840
            118872
            117628
            114820
            112008
            107140
            98364
            91636
            85820
            77100
            69444
            64440
            61300
            58828
            56908
            57620
            59156
            62248
            65344
            68312
            71208
            74508
            78284
            82060
            85592
            88516
            90856
            93192
            95532
            99792
            104476
            108472
            110996
            113524
            116052
            118752
            122092
            125436
            128776
            132120
            133632
            134940
            136044
            136972
            137900
            138856
            139968
            141084
            142196
            143312
            144424
            145232
            145232
            148668
            153908
            159544
            167780
            180004
            191540
            202124
            212712
            223296
            236188
            253368
            270548
            287356
            303956
            321344
            342596
            363848
            385680
            407560
            429880
            461200
            481840
            500840
            528600
            552160
            552160
            547040
            501560
            413280
            363240
            282724
            237224
            173320
            103292
            62640
            36170
            30698.8
            25886.4
            23388.8
            20891.2
            19260.8
            18142.4
            17025.6
            16156.4
            15310
            15048.4
            14792.8
            14657.2
            14550
            14881.2
            15212.4
            15543.6
            15898
            16684
            17469.6
            18255.6
            19041.2
            19891.2
            20862
            21832.8
            22803.6
            23774.4
            24745.2
            25773.6
            26936.8
            28100
            29263.2
            30426.4
            31589.6
            32851.2
            34397.6
            35944
            37490
            39036.4
            40584
            42088
            43592
            45092
            46592
            48148
            49708
            51268
            52496
            53412
            54080
            54520
            54540
            54164
            53788
            52276
            50572
            48828
            46948
            45072
            43340
            41716
            40092
            38467.6
            37020
            35676.4
            34332.8
            32851.6
            31075.2
            28324.4
            25470
            22574.8
            19800
            17058.4
            14677.2
            13622.4
            12567.6
            11513.2
            10477.6
            9443.6
            8591.2
            7762
            7344.8
            6927.2
            6509.6
            6193.2
            5906.8
            5620
            5366.8
            5148.8
            4930.8
            4730.8
            4602.4
            4473.6
            4345.2
            4216.8
            4088.4
            3965.08
            3857.6
            3750.12
            3642.64
            3535.16
            3427.68
            3320.2
            3226.56
            3140.28
            3053.96
            2967.68
            2881.4
            2795.12
            2708.84
            2627.64
            2554.4
            2481.16
            2407.92
            2334.68
            2261.48
            2188.24
            2115
            2051.96
            2000.48
            1949.04
            1897.56
            1846.08
            1794.28
            1741
            1687.76
            1634.48
            1583.52
            1540.48
            1497.4
            1454.36
            1411.32
            1368.28
            1325.88
            1285.16
            1244.44
            1203.68
            1152.8
            1102.2
            1102.2
            1102.2
            1101.76
            1100.48
            1115.88
            1161.64
            1207.4
            1266.04
            1333.24
            1405.24
            1515.32
            1541.76
            1560.48
            1560.48
            1548.52
            1508.44
            1459.56
            1410.52
            1361.32
            1311.88
            1262.44
            1213
            1163.56
            1114.8
            1075.44
            1036.08
            996.72
            957.36
            921.8
            890.8
            859.8
            828.8
            802.96
            782.36
            761.72
            743.84
            737.08
            730.28
            723.52
            717.08
            711.84
            706.6
            701.32
            696.08
            693.76
            693.6
            693.48
            693.32
            693.2
            693.04
            692.92
            692.76
            692.64
            692.48
            692.36
            692.2
            691.96
            691.76
            691.52
            691.32
            691.08
            690.88
            690.64
            692.44
            694.32
            696.2
            698.04
            699.92
            701.8
            705.84
            709.96
            714.08
            718.2
            722.32
            726.44
            729.84
            733.2
            736.6
            739.96
            743.6
            747.24
            750.88
            754.52
            758.16
            761.84
            765.04
            767.44
            769.8
            772.16
            774.56
            776.92
            778.4
            778.04
            777.72
            777.36
            777.04
            776.64
            772.36
            768.08
            763.84
            752.28
            737.56
            722.88
            708.16
            693.44
            678.72
            660.52
            641.08
            621.64
            602.24
            583.4
            568.92
            554.48
            540.04
            525.56
            511.12
            495.36
            473.32
            451.32
            429.32
            415.28
            402.28
            389.288
            374.944
            359.656
            344.372
            329.084
            313.796
            298.508
            283.22
            267.932
            252.648
            237.36
            222.072
            206.784]; % cm-1/M
end